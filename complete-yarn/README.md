# yarn (yet another resource negotiator) dependency management

these are the note from the course "yarn dependency management: the complete guide" by ray viljoen that i took on udemy during 3rd may 2023

# table of contents

- [introduction](#introduction)
- [installing yarn](#installing-yarn)
- [using yarn](#using-yarn)
- [package.json](#packagejson)
- [development vs regular dependencies](#development-vs-regular-dependencies)
- [specifying dependency versions](#specifying-dependency-versions)
- [yarn.lock](#yarnlock)
- [workspaces](#workspaces)
- [yarn 2 (berry)](#yarn-2-berry)
- [differences between yarn 1.x and yarn 2 (berry)](#differences-between-yarn-1x-and-yarn-2-berry)
- [yarn security](#yarn-security)
- [migrating from npm](#migrating-from-npm)
- [advantages of yarn over npm](#advantages-of-yarn-over-npm)
- [disadvantages of yarn](#disadvantages-of-yarn)

## introduction

- yarn is an alternative package manager for node.js projects, developed by facebook
- aims to provide better performance, reliability, and security compared to npm
- compatible with the npm registry, allowing developers to use yarn as a drop-in replacement for npm

## installing yarn

- visit the official yarn website (https://yarnpkg.com/) and follow the installation instructions for your operating system
- yarn can also be installed using npm: `npm install -g yarn`

## using yarn

- `yarn init`: initializes a new project and creates a `package.json` file to manage dependencies and project metadata
- `yarn add <package-name>`: installs a package and adds it to the `dependencies` section in `package.json`
  - add the `--dev` flag to install the package as a development dependency
  - add the `--global` flag to install the package globally on the system
- `yarn remove <package-name>`: uninstalls a package and removes it from `package.json`
- `yarn upgrade`: updates all packages to their latest compatible versions according to the specified version ranges in `package.json`
- `yarn outdated`: lists outdated packages with information about the current, wanted, and latest versions
- `yarn list`: lists installed packages and their dependencies
- `yarn run <script-name>`: runs a yarn script defined in the `scripts` section of `package.json`
- `yarn publish`: publishes a package to the npm registry (requires an npm account and being logged in via `yarn login`)

## package.json

- a JSON file that contains important project metadata and manages dependencies
- similar to npm's package.json, with some minor differences in the way dependencies are managed and scripts are run

## development vs regular dependencies

- development dependencies: only needed during development and not required for the application to run in production (e.g., testing, building, linting, or transpiling tools)
- regular dependencies: required for the application to function properly during runtime, both in development and production environments (e.g., frameworks, utility libraries, middleware)

## specifying dependency versions

- exact version: e.g., `"package-name": "1.2.3"`
- caret (^) range: e.g., `"package-name": "^1.2.3"`
- tilde (~) range: e.g., `"package-name": "~1.2.3"`
- wildcard (_): e.g., `"package-name": "_"`
- greater than or equal to (>=): e.g., `"package-name": ">=1.2.3"`
- less than or equal to (<=): e.g., `"package-name": "<=1.2.3"`
- combining ranges: e.g., `"package-name": "^1.2.3 || ^2.0.0"`

## yarn.lock

- automatically generated by yarn when installing packages
- ensures consistent package installation across different environments
- contains the exact version and dependency tree of installed packages

## workspaces

- a feature that enables managing multiple related packages within a single repository, allowing for better code sharing and dependency management
- useful for large projects or monorepos

## yarn 2 (berry)

- a major update to yarn, introducing features like plug'n'play (pnp), which aims to improve package installation and resolution performance
- some features and workflows in yarn 2 differ significantly from yarn 1, so it's essential to review the documentation and migration guide if you plan to upgrade

## differences between yarn 1.x and yarn 2 (berry)

1. **plug'n'play (pnp)**: yarn 2 introduces the pnp feature, which changes how dependencies are installed and resolved. instead of creating a `node_modules` folder, pnp stores the dependencies in a `.pnp.js` or `.pnp.cjs` file. this improves installation speed, reduces disk space usage, and provides more reliable dependency resolution.

2. **zero-installs**: with yarn 2, your project's dependencies can be committed to your repository, enabling "zero-install" setups. this means that developers don't need to install any dependencies when cloning the project, as they are already included in the repository, significantly improving setup time.

3. **improved workspaces**: yarn 2 enhances the workspaces feature, allowing better management of monorepos and multi-package projects. this includes improved handling of nested workspaces, better error messages, and an easier configuration process.

4. **configuration**: yarn 2 uses a new configuration file format called `.yarnrc.yml`, replacing the `.yarnrc` file in yarn 1.x. the new format is more expressive, supporting complex configurations and better validation.

5. **constraints**: yarn 2 introduces a constraints system that allows you to enforce rules about your dependencies, such as ensuring specific versions or preventing specific combinations of packages.

6. **built-in plugins**: yarn 2 comes with built-in plugins that extend its functionality, such as the `workspace-tools` plugin for managing workspaces, and the `version` plugin for handling versioning and releases.

7. **custom plugins**: yarn 2 allows you to create custom plugins to extend its functionality, enabling you to tailor the package manager to your specific needs.

8. **removal of `yarn clean`**: yarn 2 removes the `yarn clean` command, as the plug'n'play feature makes it less relevant. if you still want to remove unnecessary files from your dependencies, you can use alternative methods, like leveraging the `.gitignore` file or using third-party tools.

9. **yarn.lock format changes**: yarn 2 updates the `yarn.lock` file format, adding more metadata and making it more readable.

10. **deprecated commands**: some yarn 1.x commands have been deprecated or removed in yarn 2, such as `yarn global`, `yarn info`, and `yarn create`. yarn 2 provides alternative commands or workflows to achieve similar functionality.

note: yarn 2 introduces many changes that might require a learning curve and migration effort for existing projects. it is essential to review the documentation and migration guide if you plan to upgrade from yarn 1.x to yarn 2.

## yarn security

- yarn includes built-in security features such as:
  - integrity checks: ensuring that packages have not been tampered with during installation
  - automatic vulnerability scanning: warning developers about known security issues in their dependencies

## migrating from npm

- for most projects, transitioning from npm to yarn is straightforward
- simply run `yarn` in your project directory to generate a `yarn.lock` file and install the packages specified in `package.json`
- review and update any npm-specific scripts or commands to use the equivalent yarn commands

## advantages of yarn over npm

- faster and more efficient package installation and resolution
- improved reliability and consistency due to the `yarn.lock` file
- built-in workspaces for managing monorepos
- additional security features, such as integrity checks and vulnerability scanning

## disadvantages of yarn

- some features and workflows in yarn 2 (berry) differ significantly from yarn 1, potentially requiring a learning curve and migration effort for existing projects
- some projects or environments might not yet support yarn's new features, like plug'n'play (pnp) introduced in yarn 2
